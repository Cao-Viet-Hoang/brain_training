<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expression Puzzle - Brain Training</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üßÆ</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/expression-puzzle.css">
</head>
<body>
    <div class="container">
        <header class="game-header">
            <a href="../index.html" class="back-btn">‚Üê Back</a>
            <h1>üßÆ Expression Puzzle</h1>
            <button class="help-btn" id="helpBtn">‚ùì How to Play</button>
        </header>

        <!-- How to Play Modal -->
        <div id="helpModal" class="modal">
            <div class="modal-content">
                <span class="close-btn" id="closeHelpModal">&times;</span>
                <h2>üìñ How to Play</h2>
                <div class="help-content">
                    <div class="help-section">
                        <h3>üéØ Objective</h3>
                        <p>Place mathematical operators (+, -, √ó, √∑) between numbers to make the equation equal the target value!</p>
                    </div>
                    
                    <div class="help-section">
                        <h3>‚öôÔ∏è Setup</h3>
                        <ul>
                            <li><strong>Easy:</strong> 3-4 numbers, may include 0 or 1 (max 1 occurrence). Note: 0 and 1 only appear in Easy mode!</li>
                            <li><strong>Medium:</strong> 4-5 numbers, numbers from 2-9 only (no 0 or 1)</li>
                            <li><strong>Hard:</strong> 5-7 numbers, numbers from 2-9 only (no 0 or 1)</li>
                            <li><strong>Puzzles:</strong> Choose how many puzzles to solve (1-50)</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h3>üéÆ Gameplay</h3>
                        <ul>
                            <li>You'll see a series of numbers and a target value to reach</li>
                            <li>Click on the empty boxes (operators slots) between numbers</li>
                            <li>Choose from: + (addition), - (subtraction), √ó (multiplication), √∑ (division)</li>
                            <li><strong>IMPORTANT:</strong> Calculation is done strictly LEFT-TO-RIGHT (no operator precedence!)</li>
                            <li>Example: 2 + 3 √ó 4 = (2 + 3) √ó 4 = 20, NOT 2 + 12 = 14</li>
                            <li>When all operators are placed, the result is automatically calculated</li>
                            <li>Click Submit to verify if your result matches the target</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h3>üìä Scoring</h3>
                        <ul>
                            <li>‚úÖ Correct solutions increase your score</li>
                            <li>‚ùå Wrong answers are tracked</li>
                            <li>‚è±Ô∏è Complete puzzles faster for better time</li>
                            <li>üéØ Aim for perfect accuracy!</li>
                        </ul>
                    </div>
                    
                    <div class="help-section">
                        <h3>üí° Tips</h3>
                        <ul>
                            <li><strong>LEFT-TO-RIGHT RULE:</strong> Each operation applies to the result so far</li>
                            <li>Think step-by-step: 5 - 2 + 3 = ((5 - 2) + 3) = 3 + 3 = 6</li>
                            <li>Division must produce whole numbers only (no decimals allowed)</li>
                            <li>Work backwards: think about what operations could produce the target</li>
                            <li>Try multiplication/division first for larger jumps in value</li>
                            <li>Use addition/subtraction for fine-tuning to reach the exact target</li>
                            <li>Start with easier difficulties to master the left-to-right calculation</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <main>
            <!-- Config Screen -->
            <div id="configScreen" class="game-screen active">
                <div class="config-card">
                    <h2>Game Configuration</h2>
                    
                    <div class="config-group">
                        <label>Difficulty:</label>
                        <div class="difficulty-buttons">
                            <button class="difficulty-btn" data-difficulty="easy">
                                <span class="diff-icon">üòä</span>
                                <span class="diff-label">Easy</span>
                                <span class="diff-desc">3-4 numbers, 0/1 limit: 1</span>
                            </button>
                            <button class="difficulty-btn active" data-difficulty="medium">
                                <span class="diff-icon">ü§î</span>
                                <span class="diff-label">Medium</span>
                                <span class="diff-desc">4-5 numbers, no 0/1</span>
                            </button>
                            <button class="difficulty-btn" data-difficulty="hard">
                                <span class="diff-icon">üî•</span>
                                <span class="diff-label">Hard</span>
                                <span class="diff-desc">5-7 numbers, no 0/1</span>
                            </button>
                        </div>
                    </div>

                    <div class="config-group">
                        <label for="puzzleCount">Number of puzzles:</label>
                        <input type="number" id="puzzleCount" value="10" min="1" max="50">
                    </div>

                    <div class="config-group">
                        <label for="timePerPuzzle">Time per puzzle (seconds):</label>
                        <input type="number" id="timePerPuzzle" value="60" min="10" max="300">
                    </div>

                    <div class="config-group">
                        <label>Target range:</label>
                        <div class="range-inputs">
                            <input type="number" id="minTarget" value="10" min="1" placeholder="From">
                            <span>to</span>
                            <input type="number" id="maxTarget" value="200" min="1" placeholder="To">
                        </div>
                    </div>

                    <div class="config-group checkbox-group">
                        <label>
                            <input type="checkbox" id="requireUnique">
                            <span>Require unique solution (may take longer to generate)</span>
                        </label>
                    </div>

                    <button class="btn-primary" id="startGameBtn">Start</button>
                </div>
            </div>

            <!-- Game Screen -->
            <div id="gameScreen" class="game-screen">
                <!-- Progress Section -->
                <div class="progress-section">
                    <div class="progress-info">
                        <span>Puzzle <strong id="currentPuzzle">1</strong> of <strong id="totalPuzzles">10</strong></span>
                        <span class="timer-display">Time: <strong id="timerValue">60</strong>s</span>
                        <span class="score-display">Score: <strong id="scoreValue">0</strong></span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>

                <!-- Content Wrapper for horizontal layout -->
                <div class="game-content-wrapper">
                    <!-- Main Puzzle Area -->
                    <div class="puzzle-container">
                        <div class="expression-section">
                            <div class="expression-label">Fill in the missing numbers:</div>
                            <div class="expression-display" id="expressionDisplay">
                                <!-- Expression with inline inputs will be inserted here -->
                            </div>
                            <div class="limit-info" id="trivialNumberLimit">
                                <!-- Limit information will appear here -->
                            </div>
                        </div>

                        <div class="feedback-area" id="feedbackArea">
                            <!-- Feedback messages will appear here -->
                        </div>

                        <div class="action-buttons">
                            <button class="btn-secondary" id="hintBtn">üí° Hint</button>
                            <button class="btn-primary" id="checkAnswerBtn">Check Answer</button>
                            <button class="btn-primary" id="nextPuzzleBtn" style="display: none;">Next Puzzle ‚Üí</button>
                        </div>
                    </div>

                    <!-- Info Panel -->
                    <div class="info-panel">
                        <div class="info-card">
                            <h3>üìù Instructions</h3>
                            <ul>
                                <li>Enter numbers in the empty boxes</li>
                                <li>Make the expression equal to the target</li>
                                <li>Use the hint button if you're stuck</li>
                                <li>Press Enter or click "Check Answer"</li>
                            </ul>
                        </div>

                        <div class="info-card tips-card">
                            <h3>üí° Tips</h3>
                            <ul>
                                <li>Consider operator precedence (√ó √∑ before + ‚àí)</li>
                                <li>Pay attention to parentheses</li>
                                <li>Try working backwards from the target</li>
                                <li>Division results must be whole numbers</li>
                                <li>‚ö†Ô∏è Be careful: 0 and 1 usage is limited!</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Result Screen -->
            <div id="resultScreen" class="game-screen">
                <div class="result-card">
                    <h2>üéâ Challenge Complete!</h2>
                    
                    <div class="result-stats">
                        <div class="stat-item">
                            <div class="stat-icon">‚úì</div>
                            <div class="stat-content">
                                <div class="stat-label">Score</div>
                                <div class="stat-value">
                                    <strong id="finalScore">0</strong> / <span id="totalQuestions">10</span>
                                </div>
                            </div>
                        </div>

                        <div class="stat-item">
                            <div class="stat-icon">üìä</div>
                            <div class="stat-content">
                                <div class="stat-label">Accuracy</div>
                                <div class="stat-value" id="accuracyRate">0%</div>
                            </div>
                        </div>

                        <div class="stat-item">
                            <div class="stat-icon">‚è±Ô∏è</div>
                            <div class="stat-content">
                                <div class="stat-label">Total Time</div>
                                <div class="stat-value" id="totalTime">0s</div>
                            </div>
                        </div>
                    </div>

                    <div class="performance-message" id="performanceMessage">
                        Great job! Keep practicing!
                    </div>

                    <div class="result-actions">
                        <button class="btn-primary" id="playAgainBtn">Play Again</button>
                        <a href="../index.html" class="btn-secondary">Back to Menu</a>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>&copy; 2025 Brain Training. Challenge your mathematical thinking!</p>
        </footer>
    </div>

    <script src="expression-puzzle.js"></script>
</body>
</html>
